<!-- build time:Tue Apr 28 2020 23:14:21 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="安卓指纹+密码支付(解锁)仿支付宝Demo"><meta name="keywords" content="Android,FingerManager,指纹识别"><meta name="author" content="chengww,chengww5217@163.com"><meta name="copyright" content="chengww"><title>安卓指纹+密码支付(解锁)仿支付宝Demo | chengww's blog</title><link rel="shortcut icon" href="//js-cdn.pek3b.qingstor.com/my-favicon.ico"><link rel="stylesheet" href="//js-cdn.pek3b.qingstor.com/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容:${query}"}},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"}}</script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-前言"><span class="toc-number">1.</span> <span class="toc-text">1.前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-使用指纹识别"><span class="toc-number">2.</span> <span class="toc-text">2.使用指纹识别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#官方标准库"><span class="toc-number">2.1.</span> <span class="toc-text">官方标准库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-使用密码解锁"><span class="toc-number">3.</span> <span class="toc-text">3.使用密码解锁</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="//img-cdn.pek3b.qingstor.com/sayuri.jpg"></div><div class="author-info__name text-center">chengww</div><div class="author-info__description text-center">A blog of chengww,chengww 的个人博客</div><div class="follow-button"><a href="https://github.com/chengww5217">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">15</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">34</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">7</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image:url(//img-cdn.pek3b.qingstor.com/top-img.jpg)"><div id="page-header"><span class="pull-left"><a id="site-name" href="/">chengww's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page icon-social search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span></div><div id="post-info"><div id="post-title">安卓指纹+密码支付(解锁)仿支付宝Demo</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-05-14</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Android/">Android</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h2><p>Google 从 Android6.0（api23）就开始提供标准指纹识别支持，并对外提供指纹识别相关的接口。但是Android上的指纹识别似乎就是用来解锁手机屏幕，三方APP应用指纹的也是寥寥无几。一直想踩下安卓指纹识别的坑，直到这两天终于空出时间来尝试下android指纹识别的应用。</p><p>好吧，废话少说，show me the code，先上 Demo 截图：</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/finger-demo-shot.gif" alt=""></p><a id="more"></a><h2 id="2-使用指纹识别"><a href="#2-使用指纹识别" class="headerlink" title="2.使用指纹识别"></a>2.使用指纹识别</h2><p>点击指纹识别 button，弹出如图弹窗，弹窗使用 DialogFragment。具体实现请看下面</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/finger-demo-finger-shot.png" alt=""></p><h3 id="官方标准库"><a href="#官方标准库" class="headerlink" title="官方标准库"></a>官方标准库</h3><p>Google 提供的与指纹识别相关的核心类不多，主类是 FingerprintManager，主类依赖三个内部类，如下图所示：</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/google-finger-class01.png" alt=""></p><p>FingerprintManager 主要提供三个方法如下：</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/google-finger-class02.png" alt=""></p><p>FingerprintManager.AuthenticationCallback 类提供的回调接口如下，重点区分红色下划线标注的部分</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/google-finger-class03.png" alt=""></p><p><strong>启动指纹识别接口</strong></p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/google-finger-class04.png" alt=""></p><p>看了上面的介绍，如果要写代码就变得简单了</p><p><strong>1. AndroidManifest 权限声明</strong></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.USE_FINGERPRINT&quot;/&gt;</span><br></pre></td></tr></table></figure><p><strong>2. 获取 FingerManager 服务对象</strong></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static FingerprintManager getFingerprintManager(Context context) &#123; </span><br><span class="line">    FingerprintManager fingerprintManager = null;</span><br><span class="line">       try &#123;</span><br><span class="line">           fingerprintManager = (FingerprintManager)context.getSystemService(Context.FINGERPRINT_SERVICE); </span><br><span class="line">      &#125; catch (Throwable e) &#123; </span><br><span class="line">            Log.e(&quot;TAG&quot;,&quot;have not class FingerprintManager&quot;);</span><br><span class="line">     &#125; </span><br><span class="line">     return fingerprintManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3. 启动指纹识别</strong></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mFingerprintManager.authenticate(cryptoObject, mCancellationSignal, 0, mAuthCallback, null);</span><br></pre></td></tr></table></figure><p><strong>官方v4兼容包</strong></p><p>上面介绍最标准的官方实现指纹识别的方式，当然适配肯定没这么简单，因为有很多设备兼容性要考虑，<br>Google 后续在 v4 包中提供了一套完整的实现，实现类与上面的一一对应的，<br>就是改了个名字（FingerprintManager 改为了 FingerprintManagerCompat，<br>机智的发现 Compat 是兼容的意思，所以 Google 在 v4 包中做了一些兼容性处理），<br>做了很多兼容处理，官方推荐使用后者。v4 包中类结构如下：<br><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/google-finger-class-v4.png" alt=""><br>v4包中的类使用与上面标准库中的一致，就是名字不一样而已，这里不再介绍使用方式。</p><h2 id="3-使用密码解锁"><a href="#3-使用密码解锁" class="headerlink" title="3.使用密码解锁"></a>3.使用密码解锁</h2><p>指纹识别失败达到一定次数调用密码解锁，同指纹识别弹窗一样使用 DialogFragment。<br>用这个 DialogFragment 有个坑，稍后再讲。</p><p><img src="https://img-cdn.pek3b.qingstor.com/Persional_Android_fingerprint_useage/finger-demo-dialog-fragment.png" alt=""></p><p>密码解锁弹窗样式，fragment_pwd.xml</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginLeft</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginRight</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">"100dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"@drawable/shape_dialog"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingBottom</span>=<span class="string">"@dimen/spacing_large"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">style</span>=<span class="string">"@style/style_black_normal_text"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"@dimen/text_item_height"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_centerInParent</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"请输入密码"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">"@+id/iv_close"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"20dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"20dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"@drawable/selector_item_pressed"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_alignParentRight</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_centerVertical</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginRight</span>=<span class="string">"@dimen/spacing_tiny"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:src</span>=<span class="string">"@mipmap/icon_del"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">"@style/style_separate_line"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">com.chengww.fingerdemo.PwdView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/pwdView"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginLeft</span>=<span class="string">"@dimen/spacing_large"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginRight</span>=<span class="string">"@dimen/spacing_large"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">"@color/white"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/tv_miss_pwd"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">style</span>=<span class="string">"@style/style_blue_normal_text"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">"@dimen/text_item_right_margin"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">"@dimen/text_item_right_margin"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginRight</span>=<span class="string">"@dimen/text_item_right_margin"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"忘记密码?"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">"@drawable/selector_item_pressed"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">"end"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">"center"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.chengww.fingerdemo.InputMethodView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/inputMethodView"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>密码显示圆点框</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PwdView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; result;<span class="comment">//输入结果保存</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;<span class="comment">//密码位数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;<span class="comment">//默认每一格的大小</span></span><br><span class="line">    <span class="keyword">private</span> Paint mBorderPaint;<span class="comment">//边界画笔</span></span><br><span class="line">    <span class="keyword">private</span> Paint mDotPaint;<span class="comment">//掩盖点的画笔</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mBorderColor;<span class="comment">//边界颜色</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mDotColor;<span class="comment">//掩盖点的颜色</span></span><br><span class="line">    <span class="keyword">private</span> RectF mRoundRect;<span class="comment">//外面的圆角矩形</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mRoundRadius;<span class="comment">//圆角矩形的圆角程度</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PwdView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">        init(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> InputCallBack inputCallBack;<span class="comment">//输入完成的回调</span></span><br><span class="line">    <span class="keyword">private</span> InputMethodView inputMethodView; <span class="comment">//输入键盘</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InputCallBack</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onInputFinish</span><span class="params">(String result)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PwdView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        init(attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PwdView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        init(attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化相关参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">float</span> dp = getResources().getDisplayMetrics().density;</span><br><span class="line">        <span class="keyword">this</span>.setFocusable(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.setFocusableInTouchMode(<span class="keyword">true</span>);</span><br><span class="line">        result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (attrs != <span class="keyword">null</span>) &#123;</span><br><span class="line">            TypedArray ta = getContext().obtainStyledAttributes(attrs, R.styleable.PwdView);</span><br><span class="line">            mBorderColor = ta.getColor(R.styleable.PwdView_border_color, Color.LTGRAY);</span><br><span class="line">            mDotColor = ta.getColor(R.styleable.PwdView_dot_color, Color.BLACK);</span><br><span class="line">            count = ta.getInt(R.styleable.PwdView_count, <span class="number">6</span>);</span><br><span class="line">            ta.recycle();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mBorderColor = Color.LTGRAY;</span><br><span class="line">            mDotColor = Color.GRAY;</span><br><span class="line">            count = <span class="number">6</span>;<span class="comment">//默认6位密码</span></span><br><span class="line">        &#125;</span><br><span class="line">        size = (<span class="keyword">int</span>) (dp * <span class="number">30</span>);<span class="comment">//默认30dp一格</span></span><br><span class="line">        <span class="comment">//color</span></span><br><span class="line">        mBorderPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mBorderPaint.setStrokeWidth(<span class="number">3</span>);</span><br><span class="line">        mBorderPaint.setStyle(Paint.Style.STROKE);</span><br><span class="line">        mBorderPaint.setColor(mBorderColor);</span><br><span class="line"></span><br><span class="line">        mDotPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mDotPaint.setStrokeWidth(<span class="number">3</span>);</span><br><span class="line">        mDotPaint.setStyle(Paint.Style.FILL);</span><br><span class="line">        mDotPaint.setColor(mDotColor);</span><br><span class="line">        mRoundRect = <span class="keyword">new</span> RectF();</span><br><span class="line">        mRoundRadius = (<span class="keyword">int</span>) (<span class="number">5</span> * dp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> w = measureWidth(widthMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> h = measureHeight(heightMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> wsize = MeasureSpec.getSize(widthMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> hsize = MeasureSpec.getSize(heightMeasureSpec);</span><br><span class="line">        <span class="comment">//宽度没指定,但高度指定</span></span><br><span class="line">        <span class="keyword">if</span> (w == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (h != -<span class="number">1</span>) &#123;</span><br><span class="line">                w = h * count;<span class="comment">//宽度=高*数量</span></span><br><span class="line">                size = h;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;<span class="comment">//两个都不知道,默认宽高</span></span><br><span class="line">                w = size * count;</span><br><span class="line">                h = size;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="comment">//宽度已知</span></span><br><span class="line">            <span class="keyword">if</span> (h == -<span class="number">1</span>) &#123;<span class="comment">//高度不知道</span></span><br><span class="line">                h = w / count;</span><br><span class="line">                size = h;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        setMeasuredDimension(Math.min(w, wsize), Math.min(h, hsize));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureWidth</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//宽度</span></span><br><span class="line">        <span class="keyword">int</span> wmode = MeasureSpec.getMode(widthMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> wsize = MeasureSpec.getSize(widthMeasureSpec);</span><br><span class="line">        <span class="keyword">if</span> (wmode == MeasureSpec.AT_MOST) &#123;<span class="comment">//wrap_content</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> wsize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureHeight</span><span class="params">(<span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//高度</span></span><br><span class="line">        <span class="keyword">int</span> hmode = MeasureSpec.getMode(heightMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> hsize = MeasureSpec.getSize(heightMeasureSpec);</span><br><span class="line">        <span class="keyword">if</span> (hmode == MeasureSpec.AT_MOST) &#123;<span class="comment">//wrap_content</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hsize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getAction() == MotionEvent.ACTION_DOWN) &#123;<span class="comment">//点击控件弹出输入键盘</span></span><br><span class="line">            requestFocus();</span><br><span class="line">            inputMethodView.setVisibility(VISIBLE);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onFocusChanged</span><span class="params">(<span class="keyword">boolean</span> gainFocus, <span class="keyword">int</span> direction, Rect previouslyFocusedRect)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onFocusChanged(gainFocus, direction, previouslyFocusedRect);</span><br><span class="line">        <span class="keyword">if</span> (gainFocus) &#123;</span><br><span class="line">            inputMethodView.setVisibility(VISIBLE);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            inputMethodView.setVisibility(GONE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> width = getWidth() - <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> height = getHeight() - <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//先画个圆角矩形</span></span><br><span class="line">        mRoundRect.set(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">        canvas.drawRoundRect(mRoundRect, <span class="number">0</span>, <span class="number">0</span>, mBorderPaint);</span><br><span class="line">        <span class="comment">//画分割线</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; count; i++) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> x = i * size;</span><br><span class="line">            canvas.drawLine(x, <span class="number">0</span>, x, height, mBorderPaint);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//画掩盖点,</span></span><br><span class="line">        <span class="comment">// 这是前面定义的变量 private ArrayList&lt;Integer&gt; result;//输入结果保存</span></span><br><span class="line">        <span class="keyword">int</span> dotRadius = size / <span class="number">8</span>;<span class="comment">//圆圈占格子的三分之一</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">float</span> x = (<span class="keyword">float</span>) (size * (i + <span class="number">0.5</span>));</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">float</span> y = size / <span class="number">2</span>;</span><br><span class="line">            canvas.drawCircle(x, y, dotRadius, mDotPaint);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCheckIsTextEditor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> InputConnection <span class="title">onCreateInputConnection</span><span class="params">(EditorInfo outAttrs)</span> </span>&#123;</span><br><span class="line">        outAttrs.inputType = InputType.TYPE_CLASS_NUMBER;<span class="comment">//输入类型为数字</span></span><br><span class="line">        outAttrs.imeOptions = EditorInfo.IME_ACTION_DONE;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyInputConnection(<span class="keyword">this</span>, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInputCallBack</span><span class="params">(InputCallBack inputCallBack)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inputCallBack = inputCallBack;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        result.clear();</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInputConnection</span> <span class="keyword">extends</span> <span class="title">BaseInputConnection</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MyInputConnection</span><span class="params">(View targetView, <span class="keyword">boolean</span> fullEditor)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(targetView, fullEditor);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">commitText</span><span class="params">(CharSequence text, <span class="keyword">int</span> newCursorPosition)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//这里是接受输入法的文本的，我们只处理数字，所以什么操作都不做</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.commitText(text, newCursorPosition);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteSurroundingText</span><span class="params">(<span class="keyword">int</span> beforeLength, <span class="keyword">int</span> afterLength)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//软键盘的删除键 DEL 无法直接监听，自己发送del事件</span></span><br><span class="line">            <span class="keyword">if</span> (beforeLength == <span class="number">1</span> &amp;&amp; afterLength == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">super</span>.sendKeyEvent(<span class="keyword">new</span> KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_DEL))</span><br><span class="line">                        &amp;&amp; <span class="keyword">super</span>.sendKeyEvent(<span class="keyword">new</span> KeyEvent(KeyEvent.ACTION_UP, KeyEvent.KEYCODE_DEL));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.deleteSurroundingText(beforeLength, afterLength);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置输入键盘view</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputMethodView</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInputMethodView</span><span class="params">(InputMethodView inputMethodView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inputMethodView = inputMethodView;</span><br><span class="line">        <span class="keyword">this</span>.inputMethodView.setInputReceiver(<span class="keyword">new</span> InputMethodView.InputReceiver() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(String num)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (num.equals(<span class="string">"-1"</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!result.isEmpty()) &#123;</span><br><span class="line">                        result.remove(result.size() - <span class="number">1</span>);</span><br><span class="line">                        invalidate();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (result.size() &lt; count) &#123;</span><br><span class="line">                        result.add(num);</span><br><span class="line">                        invalidate();</span><br><span class="line">                        ensureFinishInput();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断是否输入完成，输入完成后调用callback</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ensureFinishInput</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (result.size() == count &amp;&amp; inputCallBack != <span class="keyword">null</span>) &#123;<span class="comment">//输入完成</span></span><br><span class="line">            StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="keyword">for</span> (String i : result) &#123;</span><br><span class="line">                sb.append(i);</span><br><span class="line">            &#125;</span><br><span class="line">            inputCallBack.onInputFinish(sb.toString());</span><br><span class="line">            clearResult();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取输入文字</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInputText</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (result.size() == count) &#123;</span><br><span class="line">            StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="keyword">for</span> (String i : result) &#123;</span><br><span class="line">                sb.append(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>下方输入键盘</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InputMethodView</span> <span class="keyword">extends</span> <span class="title">LinearLayout</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> InputReceiver inputReceiver;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InputMethodView</span><span class="params">(Context context, @Nullable AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        LayoutInflater.from(context).inflate(R.layout.view_password_input, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        findViewById(R.id.btn_1).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_2).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_3).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_4).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_5).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_6).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_7).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_8).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_9).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_0).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        findViewById(R.id.btn_del).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        findViewById(R.id.layout_hide).setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                setVisibility(GONE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        String num = (String) v.getTag();</span><br><span class="line">        <span class="keyword">this</span>.inputReceiver.receive(num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置接收器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> receiver</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInputReceiver</span><span class="params">(InputReceiver receiver)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inputReceiver = receiver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输入接收器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InputReceiver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">receive</span><span class="params">(String num)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MainActivity 实现输入回调就可以得到回调结果了</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">PwdView</span>.<span class="title">InputCallBack</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInputFinish</span><span class="params">(String result)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (result.equals(<span class="string">"123456"</span>)) &#123;</span><br><span class="line">            fragment.dismiss();</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"验证成功"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            showPwdError();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>今天暂时写这么多吧，整个项目还有点 BUG，标题说仿支付宝也仿的不像，<br>改天把后半部分整理出来修改下再发个完整版的。</p><p>源代码下载：<br><a href="http://git.oschina.net/chengww5217/fingerdemo" target="_blank" rel="noopener">http://git.oschina.net/chengww5217/fingerdemo</a></p><p>指纹解锁部分参考引用了以下文章，原作者指纹识别部分写的非常棒，强烈建议前往拜读：<br><a href="http://www.cnblogs.com/popfisher/p/6063835.html" target="_blank" rel="noopener">http://www.cnblogs.com/popfisher/p/6063835.html</a><br><a href="https://willowtreeapps.com/ideas/android-fingerprint-apis-an-overview-for-android-app-developers/" target="_blank" rel="noopener">https://willowtreeapps.com/ideas/android-fingerprint-apis-an-overview-for-android-app-developers/</a></p></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:chengww5217@163.com">chengww</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://chengww.com/archives/Persional_Android_fingerprint_useage.html">https://chengww.com/archives/Persional_Android_fingerprint_useage.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chengww.com">chengww's blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a><a class="post-meta__tags" href="/tags/FingerManager/">FingerManager</a><a class="post-meta__tags" href="/tags/指纹识别/">指纹识别</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/archives/How_does_the_front_end_display_the_back-end_data.html"><i class="fa fa-chevron-left"></i><span>写给产品经理之前端是如何展示后端数据的</span></a></div><div class="next-post pull-right"><a href="/archives/Android_studio_push_to_oschina.html"><span>AndroidStudio上传代码到码云(Oschina)教程</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk=new Gitalk({clientID:"d482cc178c0ea415a95c",clientSecret:"607cad7333b1f583ab878eb0fc48fd32ead10c37",repo:"blog",owner:"chengww5217",admin:"chengww5217",id:md5(decodeURI(location.pathname)),language:"zh-CN"});gitalk.render("gitalk-container")</script></div></div><footer class="footer-bg" style="background-image:url(//img-cdn.pek3b.qingstor.com/top-img.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 ❤ chengww</div><div class="footer_custom_text">Click me, kiss me, love me</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="//js-cdn.pek3b.qingstor.com/theme-melody/anime.min.js"></script><script src="//js-cdn.pek3b.qingstor.com/jquery/3.2.1/jquery.min.js"></script><script src="//js-cdn.pek3b.qingstor.com/theme-melody/jquery.fancybox.min.js"></script><script src="//js-cdn.pek3b.qingstor.com/theme-melody/velocity.min.js"></script><script src="//js-cdn.pek3b.qingstor.com/theme-melody/velocity.ui.min.js"></script><script src="//js-cdn.pek3b.qingstor.com/js/utils.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/fancybox.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/sidebar.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/copy.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/fireworks.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/transition.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/scroll.js?version=1.6.1"></script><script src="//js-cdn.pek3b.qingstor.com/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5">hexo-generator-search</a> <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html><script src="//js-cdn.pek3b.qingstor.com/clicklove/clicklove.js"></script><!-- rebuild by neat -->